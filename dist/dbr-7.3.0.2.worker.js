'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(e){var a=0;return function(){return a<e.length?{done:!1,value:e[a++]}:{done:!0}}};$jscomp.arrayIterator=function(e){return{next:$jscomp.arrayIteratorImpl(e)}};$jscomp.makeIterator=function(e){var a="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return a?a.call(e):$jscomp.arrayIterator(e)};
$jscomp.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof global&&null!=global?global:e};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,a,c){e!=Array.prototype&&e!=Object.prototype&&(e[a]=c.value)};
$jscomp.polyfill=function(e,a,c,m){if(a){c=$jscomp.global;e=e.split(".");for(m=0;m<e.length-1;m++){var l=e[m];l in c||(c[l]={});c=c[l]}e=e[e.length-1];m=c[e];a=a(m);a!=m&&null!=a&&$jscomp.defineProperty(c,e,{configurable:!0,writable:!0,value:a})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(e){function a(){this.batch_=null}function c(e){return e instanceof l?e:new l(function(a,h){a(e)})}if(e&&!$jscomp.FORCE_POLYFILL_PROMISE)return e;a.prototype.asyncExecute=function(e){if(null==this.batch_){this.batch_=[];var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})}this.batch_.push(e)};var m=$jscomp.global.setTimeout;a.prototype.asyncExecuteFunction=function(e){m(e,0)};a.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var e=
this.batch_;this.batch_=[];for(var a=0;a<e.length;++a){var h=e[a];e[a]=null;try{h()}catch(u){this.asyncThrow_(u)}}}this.batch_=null};a.prototype.asyncThrow_=function(e){this.asyncExecuteFunction(function(){throw e;})};var l=function(e){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{e(a.resolve,a.reject)}catch(h){a.reject(h)}};l.prototype.createResolveAndReject_=function(){function e(e){return function(d){h||(h=!0,e.call(a,d))}}var a=this,h=!1;
return{resolve:e(this.resolveTo_),reject:e(this.reject_)}};l.prototype.resolveTo_=function(e){if(e===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof l)this.settleSameAsPromise_(e);else{a:switch(typeof e){case "object":var a=null!=e;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(e):this.fulfill_(e)}};l.prototype.resolveToNonPromiseObj_=function(e){var a=void 0;try{a=e.then}catch(h){this.reject_(h);return}"function"==typeof a?
this.settleSameAsThenable_(a,e):this.fulfill_(e)};l.prototype.reject_=function(e){this.settle_(2,e)};l.prototype.fulfill_=function(e){this.settle_(1,e)};l.prototype.settle_=function(e,a){if(0!=this.state_)throw Error("Cannot settle("+e+", "+a+"): Promise already settled in state"+this.state_);this.state_=e;this.result_=a;this.executeOnSettledCallbacks_()};l.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var e=0;e<this.onSettledCallbacks_.length;++e)k.asyncExecute(this.onSettledCallbacks_[e]);
this.onSettledCallbacks_=null}};var k=new a;l.prototype.settleSameAsPromise_=function(e){var a=this.createResolveAndReject_();e.callWhenSettled_(a.resolve,a.reject)};l.prototype.settleSameAsThenable_=function(e,a){var d=this.createResolveAndReject_();try{e.call(a,d.resolve,d.reject)}catch(u){d.reject(u)}};l.prototype.then=function(e,a){function d(e,a){return"function"==typeof e?function(a){try{c(e(a))}catch(E){k(E)}}:a}var c,k,m=new l(function(e,a){c=e;k=a});this.callWhenSettled_(d(e,c),d(a,k));return m};
l.prototype.catch=function(e){return this.then(void 0,e)};l.prototype.callWhenSettled_=function(e,a){function d(){switch(c.state_){case 1:e(c.result_);break;case 2:a(c.result_);break;default:throw Error("Unexpected state: "+c.state_);}}var c=this;null==this.onSettledCallbacks_?k.asyncExecute(d):this.onSettledCallbacks_.push(d)};l.resolve=c;l.reject=function(e){return new l(function(a,c){c(e)})};l.race=function(e){return new l(function(a,h){for(var d=$jscomp.makeIterator(e),l=d.next();!l.done;l=d.next())c(l.value).callWhenSettled_(a,
h)})};l.all=function(e){var a=$jscomp.makeIterator(e),h=a.next();return h.done?c([]):new l(function(e,d){function l(a){return function(d){k[a]=d;m--;0==m&&e(k)}}var k=[],m=0;do k.push(void 0),m++,c(h.value).callWhenSettled_(l(k.length-1),d),h=a.next();while(!h.done)})};return l},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(e,a){this.$jscomp$symbol$id_=e;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:a})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function e(c){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+a++,c)}var a=0;return e}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.iterator;e||(e=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[e]&&$jscomp.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.asyncIterator;e||(e=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(e){$jscomp.initSymbolIterator();e={next:e};e[$jscomp.global.Symbol.iterator]=function(){return this};return e};$jscomp.underscoreProtoCanBeSet=function(){var e={a:!0},a={};try{return a.__proto__=e,a.a}catch(c){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(e,a){e.__proto__=a;if(e.__proto__!==a)throw new TypeError(e+" is not extensible");return e}:null;$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(e){if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(e){this.yieldResult=e};$jscomp.generator.Context.prototype.throw_=function(e){this.abruptCompletion_={exception:e,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(e){this.abruptCompletion_={return:e};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(e){this.abruptCompletion_={jumpTo:e};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(e,a){this.nextAddress=a;return{value:e}};$jscomp.generator.Context.prototype.yieldAll=function(e,a){e=$jscomp.makeIterator(e);var c=e.next();$jscomp.generator.ensureIteratorResultIsObject_(c);if(c.done)this.yieldResult=c.value,this.nextAddress=a;else return this.yieldAllIterator_=e,this.yield(c.value,a)};
$jscomp.generator.Context.prototype.jumpTo=function(e){this.nextAddress=e};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(e,a){this.catchAddress_=e;void 0!=a&&(this.finallyAddress_=a)};$jscomp.generator.Context.prototype.setFinallyBlock=function(e){this.catchAddress_=0;this.finallyAddress_=e||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(e,a){this.nextAddress=e;this.catchAddress_=a||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(e){this.catchAddress_=e||0;e=this.abruptCompletion_.exception;this.abruptCompletion_=null;return e};$jscomp.generator.Context.prototype.enterFinallyBlock=function(e,a,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=e||0;this.finallyAddress_=a||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(e,a){a=this.finallyContexts_.splice(a||0)[0];if(a=this.abruptCompletion_=this.abruptCompletion_||a){if(a.isException)return this.jumpToErrorHandler_();void 0!=a.jumpTo&&this.finallyAddress_<a.jumpTo?(this.nextAddress=a.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=e};$jscomp.generator.Context.prototype.forIn=function(e){return new $jscomp.generator.Context.PropertyIterator(e)};
$jscomp.generator.Context.PropertyIterator=function(e){this.object_=e;this.properties_=[];for(var a in e)this.properties_.push(a);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var e=this.properties_.pop();if(e in this.object_)return e}return null};$jscomp.generator.Engine_=function(e){this.context_=new $jscomp.generator.Context;this.program_=e};
$jscomp.generator.Engine_.prototype.next_=function(e){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,e,this.context_.next_);this.context_.next_(e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(e){this.context_.start_();var a=this.context_.yieldAllIterator_;if(a)return this.yieldAllStep_("return"in a?a["return"]:function(e){return{value:e,done:!0}},e,this.context_.return);this.context_.return(e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(e){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],e,this.context_.next_);this.context_.throw_(e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(e,a,c){try{var m=e.call(this.context_.yieldAllIterator_,a);$jscomp.generator.ensureIteratorResultIsObject_(m);if(!m.done)return this.context_.stop_(),m;var l=m.value}catch(k){return this.context_.yieldAllIterator_=null,this.context_.throw_(k),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var e=this.program_(this.context_);if(e)return this.context_.stop_(),{value:e.value,done:!1}}catch(a){this.context_.yieldResult=void 0,this.context_.throw_(a)}this.context_.stop_();if(this.context_.abruptCompletion_){e=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(e.isException)throw e.exception;return{value:e.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(e){this.next=function(a){return e.next_(a)};this.throw=function(a){return e.throw_(a)};this.return=function(a){return e.return_(a)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(e,a){a=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(a,e.prototype);return a};
$jscomp.asyncExecutePromiseGenerator=function(e){function a(a){return e.next(a)}function c(a){return e.throw(a)}return new Promise(function(m,l){function k(e){e.done?m(e.value):Promise.resolve(e.value).then(a,c).then(k,l)}k(e.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(e){return $jscomp.asyncExecutePromiseGenerator(e())};$jscomp.asyncExecutePromiseGeneratorProgram=function(e){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(e)))};
const dbrBNode=!!("object"==typeof global&&global.process&&global.process.release&&global.process.release.name);let worker_threads;dbrBNode&&(worker_threads=require("worker_threads"));
let parentPort=dbrBNode?worker_threads.parentPort:self,dbrBWasmDebug,dbrEngineResourcePath,dbrVersion,dbrProductKeys,dbrBRuntimeKeys,dbrDomain,dbrBNewDevice=!1,dbrBUseFullFeature=!1,dbrDeviceId,dbrBrowserInfo,dbrDeviceFriendlyName,dbrLicenseServer="https://dbrjsauth.dynamsoft.com/v2/",dbrTimeStartLoadWasm,dbrPromiseGetLicense,dbrLicenseInfo,dbrPromisePostConsumption=Promise.resolve();
dbrBNode||!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).localforage=e()}(function(){return function l(a,c,m){function k(d,u){if(!c[d]){if(!a[d]){var h="function"==typeof require&&require;if(!u&&h)return h(d,!0);if(q)return q(d,!0);u=Error("Cannot find module '"+d+"'");throw u.code="MODULE_NOT_FOUND",u;}u=
c[d]={exports:{}};a[d][0].call(u.exports,function(c){return k(a[d][1][c]||c)},u,u.exports,l,a,c,m)}return c[d].exports}for(var q="function"==typeof require&&require,d=0;d<m.length;d++)k(m[d]);return k}({1:[function(a,c,m){(function(a){function k(){y=!0;for(var a,d,c=r.length;c;){d=r;r=[];for(a=-1;++a<c;)d[a]();c=r.length}y=!1}var l=a.MutationObserver||a.WebKitMutationObserver;if(l){var d=0;l=new l(k);var h=a.document.createTextNode("");l.observe(h,{characterData:!0});var m=function(){h.data=d=++d%
2}}else if(a.setImmediate||void 0===a.MessageChannel)m="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var d=a.document.createElement("script");d.onreadystatechange=function(){k();d.onreadystatechange=null;d.parentNode.removeChild(d);d=null};a.document.documentElement.appendChild(d)}:function(){setTimeout(k,0)};else{var D=new a.MessageChannel;D.port1.onmessage=k;m=function(){D.port2.postMessage(0)}}var y,r=[];c.exports=function(a){1!==r.push(a)||y||m()}}).call(this,
"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(a,c,m){function l(){}function k(a){if("function"!=typeof a)throw new TypeError("resolver must be a function");this.state=E;this.queue=[];this.outcome=void 0;a!==l&&u(this,a)}function q(a,d,c){this.promise=a;"function"==typeof d&&(this.onFulfilled=d,this.callFulfilled=this.otherCallFulfilled);"function"==typeof c&&(this.onRejected=c,this.callRejected=this.otherCallRejected)}function d(a,
d,c){y(function(){try{var h=d(c)}catch(x){return r.reject(a,x)}h===a?r.reject(a,new TypeError("Cannot resolve promise with itself")):r.resolve(a,h)})}function h(a){var d=a&&a.then;if(a&&("object"==typeof a||"function"==typeof a)&&"function"==typeof d)return function(){d.apply(a,arguments)}}function u(a,d){function c(d){l||(l=!0,r.reject(a,d))}function h(d){l||(l=!0,r.resolve(a,d))}var l=!1,k=D(function(){d(h,c)});"error"===k.status&&c(k.value)}function D(a,d){var c={};try{c.value=a(d),c.status="success"}catch(P){c.status=
"error",c.value=P}return c}var y=a(1),r={},F=["REJECTED"],v=["FULFILLED"],E=["PENDING"];c.exports=k;k.prototype.catch=function(a){return this.then(null,a)};k.prototype.then=function(a,c){if("function"!=typeof a&&this.state===v||"function"!=typeof c&&this.state===F)return this;var h=new this.constructor(l);this.state!==E?d(h,this.state===v?a:c,this.outcome):this.queue.push(new q(h,a,c));return h};q.prototype.callFulfilled=function(a){r.resolve(this.promise,a)};q.prototype.otherCallFulfilled=function(a){d(this.promise,
this.onFulfilled,a)};q.prototype.callRejected=function(a){r.reject(this.promise,a)};q.prototype.otherCallRejected=function(a){d(this.promise,this.onRejected,a)};r.resolve=function(a,d){var c=D(h,d);if("error"===c.status)return r.reject(a,c.value);if(c=c.value)u(a,c);else{a.state=v;a.outcome=d;c=-1;for(var l=a.queue.length;++c<l;)a.queue[c].callFulfilled(d)}return a};r.reject=function(a,d){a.state=F;a.outcome=d;for(var c=-1,h=a.queue.length;++c<h;)a.queue[c].callRejected(d);return a};k.resolve=function(a){return a instanceof
this?a:r.resolve(new this(l),a)};k.reject=function(a){var d=new this(l);return r.reject(d,a)};k.all=function(a){function d(a,d){c.resolve(a).then(function(a){m[d]=a;++q!==h||k||(k=!0,r.resolve(v,m))},function(a){k||(k=!0,r.reject(v,a))})}var c=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var h=a.length,k=!1;if(!h)return this.resolve([]);for(var m=Array(h),q=0,u=-1,v=new this(l);++u<h;)d(a[u],u);return v};k.race=function(a){function d(a){c.resolve(a).then(function(a){k||
(k=!0,r.resolve(q,a))},function(a){k||(k=!0,r.reject(q,a))})}var c=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var h=a.length,k=!1;if(!h)return this.resolve([]);for(var m=-1,q=new this(l);++m<h;)d(a[m]);return q}},{1:1}],3:[function(a,c,m){c="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};"function"!=typeof c.Promise&&(c.Promise=a(2))},{2:2}],4:[function(a,c,m){function l(b,
a){b=b||[];a=a||{};try{return new Blob(b,a)}catch(B){if("TypeError"!==B.name)throw B;for(var f=new ("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),t=0;t<b.length;t+=1)f.append(b[t]);return f.getBlob(a.type)}}function k(b,a){a&&b.then(function(b){a(null,b)},function(b){a(b)})}function q(b,a,g){"function"==typeof a&&b.then(a);"function"==typeof g&&b.catch(g)}function d(b){return"string"!=
typeof b&&(console.warn(b+" used as a key, but it is not a string."),b=String(b)),b}function h(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function u(b){return(new p(function(a){var f=b.transaction(R,M),t=l([""]);f.objectStore(R).put(t,"key");f.onabort=function(b){b.preventDefault();b.stopPropagation();a(!1)};f.oncomplete=function(){var b=navigator.userAgent.match(/Chrome\/(\d+)/),f=navigator.userAgent.match(/Edge\//);a(f||!b||43<=parseInt(b[1],
10))}})).catch(function(){return!1})}function D(b){return"boolean"==typeof S?p.resolve(S):u(b).then(function(b){return S=b})}function y(b){b=w[b.name];var a={};a.promise=new p(function(b,f){a.resolve=b;a.reject=f});b.deferredOperations.push(a);b.dbReady?b.dbReady=b.dbReady.then(function(){return a.promise}):b.dbReady=a.promise}function r(b){if(b=w[b.name].deferredOperations.pop())return b.resolve(),b.promise}function F(b,a){if(b=w[b.name].deferredOperations.pop())return b.reject(a),b.promise}function v(b,
a){return new p(function(f,d){if(w[b.name]=w[b.name]||aa(),b.db){if(!a)return f(b.db);y(b);b.db.close()}var g=[b.name];a&&g.push(b.version);var t=I.open.apply(I,g);a&&(t.onupgradeneeded=function(a){var f=t.result;try{f.createObjectStore(b.storeName),1>=a.oldVersion&&f.createObjectStore(R)}catch(z){if("ConstraintError"!==z.name)throw z;console.warn('The database "'+b.name+'" has been upgraded from version '+a.oldVersion+" to version "+a.newVersion+', but the storage "'+b.storeName+'" already exists.')}});
t.onerror=function(b){b.preventDefault();d(t.error)};t.onsuccess=function(){f(t.result);r(b)}})}function E(b,a){if(!b.db)return!0;var f=!b.db.objectStoreNames.contains(b.storeName),t=b.version>b.db.version;return(b.version<b.db.version&&(b.version!==a&&console.warn('The database "'+b.name+"\" can't be downgraded from version "+b.db.version+" to version "+b.version+"."),b.version=b.db.version),t||f)?(f&&(a=b.db.version+1,a>b.version&&(b.version=a)),!0):!1}function ka(b){return new p(function(a,g){var f=
new FileReader;f.onerror=g;f.onloadend=function(f){f=btoa(f.target.result||"");a({__local_forage_encoded_blob:!0,data:f,type:b.type})};f.readAsBinaryString(b)})}function Y(b){for(var a=atob(b.data),g=a.length,d=new ArrayBuffer(g),c=new Uint8Array(d),n=0;n<g;n++)c[n]=a.charCodeAt(n);return l([d],{type:b.type})}function la(b){var a=this,g=a._initReady().then(function(){var b=w[a._dbInfo.name];if(b&&b.dbReady)return b.dbReady});return q(g,b,b),g}function P(b){y(b);for(var a=w[b.name],g=a.forages,d=0;d<
g.length;d++){var c=g[d];c._dbInfo.db&&(c._dbInfo.db.close(),c._dbInfo.db=null)}return b.db=null,v(b,!1).then(function(a){return b.db=a,E(b)?v(b,!0):a}).then(function(f){b.db=a.db=f;for(var d=0;d<g.length;d++)g[d]._dbInfo.db=f}).catch(function(a){throw F(b,a),a;})}function x(b,a,g,d){void 0===d&&(d=1);try{var f=b.db.transaction(b.storeName,a);g(null,f)}catch(n){if(0<d&&(!b.db||"InvalidStateError"===n.name||"NotFoundError"===n.name))return p.resolve().then(function(){if(!b.db||"NotFoundError"===n.name&&
!b.db.objectStoreNames.contains(b.storeName)&&b.version<=b.db.version)return b.db&&(b.version=b.db.version+1),v(b,!0)}).then(function(){return P(b).then(function(){x(b,a,g,d-1)})}).catch(g);g(n)}}function aa(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Z(b){var a=.75*b.length;var g=b.length,d=0;"="===b[b.length-1]&&(a--,"="===b[b.length-2]&&a--);var c=new ArrayBuffer(a),n=new Uint8Array(c);for(a=0;a<g;a+=4){var h=C.indexOf(b[a]);var J=C.indexOf(b[a+1]);var z=C.indexOf(b[a+
2]);var k=C.indexOf(b[a+3]);n[d++]=h<<2|J>>4;n[d++]=(15&J)<<4|z>>2;n[d++]=(3&z)<<6|63&k}return c}function Q(a){var b=new Uint8Array(a),g="";for(a=0;a<b.length;a+=3)g+=C[b[a]>>2],g+=C[(3&b[a])<<4|b[a+1]>>4],g+=C[(15&b[a+1])<<2|b[a+2]>>6],g+=C[63&b[a+2]];return 2==b.length%3?g=g.substring(0,g.length-1)+"=":1==b.length%3&&(g=g.substring(0,g.length-2)+"=="),g}function ca(a,f,g,d){a.executeSql("CREATE TABLE IF NOT EXISTS "+f.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],g,d)}function A(a,
f,g,d,c,n){a.executeSql(g,d,c,function(a,b){b.code===b.SYNTAX_ERR?a.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[f.storeName],function(a,t){t.rows.length?n(a,b):ca(a,f,function(){a.executeSql(g,d,c,n)},n)},n):n(a,b)},n)}function ba(a,f,g,c){var b=this;a=d(a);var n=new p(function(d,n){b.ready().then(function(){void 0===f&&(f=null);var t=f,B=b._dbInfo;B.serializer.serialize(f,function(f,h){h?n(h):B.db.transaction(function(b){A(b,B,"INSERT OR REPLACE INTO "+B.storeName+
" (key, value) VALUES (?, ?)",[a,f],function(){d(t)},function(a,b){n(b)})},function(f){if(f.code===f.QUOTA_ERR){if(0<c)return void d(ba.apply(b,[a,t,g,c-1]));n(f)}})})}).catch(n)});return k(n,g),n}function ma(a){return new p(function(b,g){a.transaction(function(f){f.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(f,g){f=[];for(var d=0;d<g.rows.length;d++)f.push(g.rows.item(d).name);b({db:a,storeNames:f})},function(a,b){g(b)})},function(a){g(a)})})}
function ea(a,f){var b=a.name+"/";return a.storeName!==f.storeName&&(b+=a.storeName+"/"),b}function na(a,f){a[f]=function(){var b=arguments;return a.ready().then(function(){return a[f].apply(a,b)})}}function V(){for(var a=1;a<arguments.length;a++){var f=arguments[a];if(f)for(var g in f)f.hasOwnProperty(g)&&(fa(f[g])?arguments[0][g]=f[g].slice():arguments[0][g]=f[g])}return arguments[0]}var oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&
"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},I=function(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}();"undefined"==typeof Promise&&a(3);var p=Promise,R="local-forage-detect-blob-support",S=void 0,w={},pa=Object.prototype.toString,
M="readwrite";a={_driver:"asyncStorage",_initStorage:function(a){function b(){return p.resolve()}var g=this,d={db:null};if(a)for(var c in a)d[c]=a[c];var n=w[d.name];n||(n=aa(),w[d.name]=n);n.forages.push(g);g._initReady||(g._initReady=g.ready,g.ready=la);a=[];for(c=0;c<n.forages.length;c++){var h=n.forages[c];h!==g&&a.push(h._initReady().catch(b))}var J=n.forages.slice(0);return p.all(a).then(function(){return d.db=n.db,v(d,!1)}).then(function(a){return d.db=a,E(d,g._defaultConfig.version)?v(d,!0):
a}).then(function(a){d.db=n.db=a;g._dbInfo=d;for(a=0;a<J.length;a++){var b=J[a];b!==g&&(b._dbInfo.db=d.db,b._dbInfo.version=d.version)}})},_support:function(){try{if(!I)return!1;var a="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),f="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!a||f)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(g){return!1}}(),
iterate:function(a,f){var b=this,d=new p(function(f,d){b.ready().then(function(){x(b._dbInfo,"readonly",function(g,c){if(g)return d(g);try{var n=c.objectStore(b._dbInfo.storeName).openCursor(),t=1;n.onsuccess=function(){var b=n.result;if(b){var d=b.value;d&&d.__local_forage_encoded_blob&&(d=Y(d));d=a(d,b.key,t++);void 0!==d?f(d):b.continue()}else f()};n.onerror=function(){d(n.error)}}catch(T){d(T)}})}).catch(d)});return k(d,f),d},getItem:function(a,f){var b=this;a=d(a);var c=new p(function(d,f){b.ready().then(function(){x(b._dbInfo,
"readonly",function(g,c){if(g)return f(g);try{var n=c.objectStore(b._dbInfo.storeName).get(a);n.onsuccess=function(){var a=n.result;void 0===a&&(a=null);a&&a.__local_forage_encoded_blob&&(a=Y(a));d(a)};n.onerror=function(){f(n.error)}}catch(K){f(K)}})}).catch(f)});return k(c,f),c},setItem:function(a,f,g){var b=this;a=d(a);var c=new p(function(d,g){var c;b.ready().then(function(){return c=b._dbInfo,"[object Blob]"===pa.call(f)?D(c.db).then(function(a){return a?f:ka(f)}):f}).then(function(f){x(b._dbInfo,
M,function(c,n){if(c)return g(c);try{var t=n.objectStore(b._dbInfo.storeName);null===f&&(f=void 0);var h=t.put(f,a);n.oncomplete=function(){void 0===f&&(f=null);d(f)};n.onabort=n.onerror=function(){g(h.error?h.error:h.transaction.error)}}catch(U){g(U)}})}).catch(g)});return k(c,g),c},removeItem:function(a,f){var b=this;a=d(a);var c=new p(function(d,f){b.ready().then(function(){x(b._dbInfo,M,function(g,c){if(g)return f(g);try{var n=c.objectStore(b._dbInfo.storeName).delete(a);c.oncomplete=function(){d()};
c.onerror=function(){f(n.error)};c.onabort=function(){f(n.error?n.error:n.transaction.error)}}catch(K){f(K)}})}).catch(f)});return k(c,f),c},clear:function(a){var b=this,d=new p(function(a,d){b.ready().then(function(){x(b._dbInfo,M,function(f,g){if(f)return d(f);try{var c=g.objectStore(b._dbInfo.storeName).clear();g.oncomplete=function(){a()};g.onabort=g.onerror=function(){d(c.error?c.error:c.transaction.error)}}catch(z){d(z)}})}).catch(d)});return k(d,a),d},length:function(a){var b=this,d=new p(function(a,
d){b.ready().then(function(){x(b._dbInfo,"readonly",function(f,g){if(f)return d(f);try{var c=g.objectStore(b._dbInfo.storeName).count();c.onsuccess=function(){a(c.result)};c.onerror=function(){d(c.error)}}catch(z){d(z)}})}).catch(d)});return k(d,a),d},key:function(a,d){var b=this,f=new p(function(d,f){if(0>a)return void d(null);b.ready().then(function(){x(b._dbInfo,"readonly",function(g,c){if(g)return f(g);try{var n=!1,h=c.objectStore(b._dbInfo.storeName).openCursor();h.onsuccess=function(){var b=
h.result;if(!b)return void d(null);0===a?d(b.key):n?d(b.key):(n=!0,b.advance(a))};h.onerror=function(){f(h.error)}}catch(T){f(T)}})}).catch(f)});return k(f,d),f},keys:function(a){var b=this,d=new p(function(a,d){b.ready().then(function(){x(b._dbInfo,"readonly",function(f,g){if(f)return d(f);try{var c=g.objectStore(b._dbInfo.storeName).openCursor(),n=[];c.onsuccess=function(){var b=c.result;if(!b)return void a(n);n.push(b.key);b.continue()};c.onerror=function(){d(c.error)}}catch(K){d(K)}})}).catch(d)});
return k(d,a),d},dropInstance:function(a,d){d=h.apply(this,arguments);var b=this.config();a="function"!=typeof a&&a||{};a.name||(a.name=a.name||b.name,a.storeName=a.storeName||b.storeName);a.name?(b=a.name===b.name&&this._dbInfo.db?p.resolve(this._dbInfo.db):v(a,!1).then(function(b){var d=w[a.name],f=d.forages;d.db=b;for(d=0;d<f.length;d++)f[d]._dbInfo.db=b;return b}),b=a.storeName?b.then(function(b){if(b.objectStoreNames.contains(a.storeName)){var d=b.version+1;y(a);var f=w[a.name],c=f.forages;b.close();
for(b=0;b<c.length;b++){var g=c[b];g._dbInfo.db=null;g._dbInfo.version=d}return(new p(function(b,f){var c=I.open(a.name,d);c.onerror=function(a){c.result.close();f(a)};c.onupgradeneeded=function(){c.result.deleteObjectStore(a.storeName)};c.onsuccess=function(){var a=c.result;a.close();b(a)}})).then(function(a){f.db=a;for(var b=0;b<c.length;b++){var d=c[b];d._dbInfo.db=a;r(d._dbInfo)}}).catch(function(b){throw(F(a,b)||p.resolve()).catch(function(){}),b;})}}):b.then(function(b){y(a);var d=w[a.name],
f=d.forages;b.close();for(b=0;b<f.length;b++)f[b]._dbInfo.db=null;return(new p(function(b,d){var f=I.deleteDatabase(a.name);f.onerror=f.onblocked=function(a){var b=f.result;b&&b.close();d(a)};f.onsuccess=function(){var a=f.result;a&&a.close();b(a)}})).then(function(a){d.db=a;for(a=0;a<f.length;a++)r(f[a]._dbInfo)}).catch(function(b){throw(F(a,b)||p.resolve()).catch(function(){}),b;})})):b=p.reject("Invalid arguments");return k(b,d),b}};var C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",
ha=/^~~local_forage_type~([^~]+)~/,ia=Object.prototype.toString,W={serialize:function(a,d){var b="";if(a&&(b=ia.call(a)),a&&("[object ArrayBuffer]"===b||a.buffer&&"[object ArrayBuffer]"===ia.call(a.buffer))){var f,c="__lfsc__:";a instanceof ArrayBuffer?(f=a,c+="arbf"):(f=a.buffer,"[object Int8Array]"===b?c+="si08":"[object Uint8Array]"===b?c+="ui08":"[object Uint8ClampedArray]"===b?c+="uic8":"[object Int16Array]"===b?c+="si16":"[object Uint16Array]"===b?c+="ur16":"[object Int32Array]"===b?c+="si32":
"[object Uint32Array]"===b?c+="ui32":"[object Float32Array]"===b?c+="fl32":"[object Float64Array]"===b?c+="fl64":d(Error("Failed to get type for BinaryArray")));d(c+Q(f))}else if("[object Blob]"===b)b=new FileReader,b.onload=function(){var b="~~local_forage_type~"+a.type+"~"+Q(this.result);d("__lfsc__:blob"+b)},b.readAsArrayBuffer(a);else try{d(JSON.stringify(a))}catch(n){console.error("Couldn't convert value into a JSON string: ",a),d(null,n)}},deserialize:function(a){if("__lfsc__:"!==a.substring(0,
9))return JSON.parse(a);var b=a.substring(13);a=a.substring(9,13);if("blob"===a&&ha.test(b)){var d=b.match(ha);var c=d[1];b=b.substring(d[0].length)}b=Z(b);switch(a){case "arbf":return b;case "blob":return l([b],{type:c});case "si08":return new Int8Array(b);case "ui08":return new Uint8Array(b);case "uic8":return new Uint8ClampedArray(b);case "si16":return new Int16Array(b);case "ur16":return new Uint16Array(b);case "si32":return new Int32Array(b);case "ui32":return new Uint32Array(b);case "fl32":return new Float32Array(b);
case "fl64":return new Float64Array(b);default:throw Error("Unkown type: "+a);}},stringToBuffer:Z,bufferToString:Q};m={_driver:"webSQLStorage",_initStorage:function(a){var b=this,d={db:null};if(a)for(var c in a)d[c]="string"!=typeof a[c]?a[c].toString():a[c];a=new p(function(a,f){try{d.db=openDatabase(d.name,String(d.version),d.description,d.size)}catch(da){return f(da)}d.db.transaction(function(c){ca(c,d,function(){b._dbInfo=d;a()},function(a,b){f(b)})},f)});return d.serializer=W,a},_support:"function"==
typeof openDatabase,iterate:function(a,d){var b=this,f=new p(function(d,f){b.ready().then(function(){var c=b._dbInfo;c.db.transaction(function(b){A(b,c,"SELECT * FROM "+c.storeName,[],function(b,f){b=f.rows;f=b.length;for(var g=0;g<f;g++){var h=b.item(g),n=h.value;if(n&&(n=c.serializer.deserialize(n)),void 0!==(n=a(n,h.key,g+1)))return void d(n)}d()},function(a,b){f(b)})})}).catch(f)});return k(f,d),f},getItem:function(a,f){var b=this;a=d(a);var c=new p(function(d,f){b.ready().then(function(){var c=
b._dbInfo;c.db.transaction(function(b){A(b,c,"SELECT * FROM "+c.storeName+" WHERE key = ? LIMIT 1",[a],function(a,b){(a=b.rows.length?b.rows.item(0).value:null)&&(a=c.serializer.deserialize(a));d(a)},function(a,b){f(b)})})}).catch(f)});return k(c,f),c},setItem:function(a,d,c){return ba.apply(this,[a,d,c,1])},removeItem:function(a,c){var b=this;a=d(a);var f=new p(function(d,c){b.ready().then(function(){var f=b._dbInfo;f.db.transaction(function(b){A(b,f,"DELETE FROM "+f.storeName+" WHERE key = ?",[a],
function(){d()},function(a,b){c(b)})})}).catch(c)});return k(f,c),f},clear:function(a){var b=this,d=new p(function(a,d){b.ready().then(function(){var c=b._dbInfo;c.db.transaction(function(b){A(b,c,"DELETE FROM "+c.storeName,[],function(){a()},function(a,b){d(b)})})}).catch(d)});return k(d,a),d},length:function(a){var b=this,d=new p(function(a,d){b.ready().then(function(){var c=b._dbInfo;c.db.transaction(function(b){A(b,c,"SELECT COUNT(key) as c FROM "+c.storeName,[],function(b,d){b=d.rows.item(0).c;
a(b)},function(a,b){d(b)})})}).catch(d)});return k(d,a),d},key:function(a,d){var b=this,c=new p(function(d,c){b.ready().then(function(){var f=b._dbInfo;f.db.transaction(function(b){A(b,f,"SELECT key FROM "+f.storeName+" WHERE id = ? LIMIT 1",[a+1],function(a,b){a=b.rows.length?b.rows.item(0).key:null;d(a)},function(a,b){c(b)})})}).catch(c)});return k(c,d),c},keys:function(a){var b=this,d=new p(function(a,d){b.ready().then(function(){var c=b._dbInfo;c.db.transaction(function(b){A(b,c,"SELECT key FROM "+
c.storeName,[],function(b,d){b=[];for(var c=0;c<d.rows.length;c++)b.push(d.rows.item(c).key);a(b)},function(a,b){d(b)})})}).catch(d)});return k(d,a),d},dropInstance:function(a,d){d=h.apply(this,arguments);var b=this.config();a="function"!=typeof a&&a||{};a.name||(a.name=a.name||b.name,a.storeName=a.storeName||b.storeName);var c,f=this;return c=a.name?(new p(function(d){var c=a.name===b.name?f._dbInfo.db:openDatabase(a.name,"","",0);d(a.storeName?{db:c,storeNames:[a.storeName]}:ma(c))})).then(function(a){return new p(function(b,
d){a.db.transaction(function(c){function f(a){return new p(function(b,d){c.executeSql("DROP TABLE IF EXISTS "+a,[],function(){b()},function(a,b){d(b)})})}for(var g=[],h=0,n=a.storeNames.length;h<n;h++)g.push(f(a.storeNames[h]));p.all(g).then(function(){b()}).catch(function(a){d(a)})},function(a){d(a)})})}):p.reject("Invalid arguments"),k(c,d),c}};try{var G="undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(b){G=!1}var qa=function(a,d){for(var b=a.length,c=0;c<
b;){var f=a[c],h=d;if(f===h||"number"==typeof f&&"number"==typeof h&&isNaN(f)&&isNaN(h))return!0;c++}return!1},fa=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},L={},ja={},H={INDEXEDDB:a,WEBSQL:m,LOCALSTORAGE:{_driver:"localStorageWrapper",_initStorage:function(a){var b={};if(a)for(var d in a)b[d]=a[d];b.keyPrefix=ea(a,this._defaultConfig);try{var c=(localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1)}catch(B){c=
!0}return!c||0<localStorage.length?(this._dbInfo=b,b.serializer=W,p.resolve()):p.reject()},_support:G,iterate:function(a,d){var b=this,c=b.ready().then(function(){for(var d=b._dbInfo,c=d.keyPrefix,f=c.length,g=localStorage.length,h=1,k=0;k<g;k++){var l=localStorage.key(k);if(0===l.indexOf(c)){var m=localStorage.getItem(l);if(m&&(m=d.serializer.deserialize(m)),void 0!==(m=a(m,l.substring(f),h++)))return m}}});return k(c,d),c},getItem:function(a,c){var b=this;a=d(a);var f=b.ready().then(function(){var d=
b._dbInfo,c=localStorage.getItem(d.keyPrefix+a);return c&&(c=d.serializer.deserialize(c)),c});return k(f,c),f},setItem:function(a,c,g){var b=this;a=d(a);var f=b.ready().then(function(){void 0===c&&(c=null);var d=c;return new p(function(f,g){var h=b._dbInfo;h.serializer.serialize(c,function(b,c){if(c)g(c);else try{localStorage.setItem(h.keyPrefix+a,b),f(d)}catch(N){"QuotaExceededError"!==N.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==N.name||g(N),g(N)}})})});return k(f,g),f},removeItem:function(a,c){var b=
this;a=d(a);var f=b.ready().then(function(){localStorage.removeItem(b._dbInfo.keyPrefix+a)});return k(f,c),f},clear:function(a){var b=this,d=b.ready().then(function(){for(var a=b._dbInfo.keyPrefix,d=localStorage.length-1;0<=d;d--){var c=localStorage.key(d);0===c.indexOf(a)&&localStorage.removeItem(c)}});return k(d,a),d},length:function(a){var b=this.keys().then(function(a){return a.length});return k(b,a),b},key:function(a,d){var b=this,c=b.ready().then(function(){var d=b._dbInfo;try{var c=localStorage.key(a)}catch(da){c=
null}return c&&(c=c.substring(d.keyPrefix.length)),c});return k(c,d),c},keys:function(a){var b=this,d=b.ready().then(function(){for(var a=b._dbInfo,d=localStorage.length,c=[],f=0;f<d;f++){var g=localStorage.key(f);0===g.indexOf(a.keyPrefix)&&c.push(g.substring(a.keyPrefix.length))}return c});return k(d,a),d},dropInstance:function(a,d){if(d=h.apply(this,arguments),a="function"!=typeof a&&a||{},!a.name){var b=this.config();a.name=a.name||b.name;a.storeName=a.storeName||b.storeName}var c,f=this;return c=
a.name?(new p(function(b){b(a.storeName?ea(a,f._defaultConfig):a.name+"/")})).then(function(a){for(var b=localStorage.length-1;0<=b;b--){var d=localStorage.key(b);0===d.indexOf(a)&&localStorage.removeItem(d)}}):p.reject("Invalid arguments"),k(c,d),c}}};G=[H.INDEXEDDB._driver,H.WEBSQL._driver,H.LOCALSTORAGE._driver];var O=["dropInstance"],X="clear getItem iterate key keys length removeItem setItem".split(" ").concat(O),ra={description:"",driver:G.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",
version:1};G=new (function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");for(var d in H)if(H.hasOwnProperty(d)){var c=H[d],f=c._driver;this[d]=f;L[f]||this.defineDriver(c)}this._defaultConfig=V({},ra);this._config=V({},this._defaultConfig,b);this._initDriver=this._driverSet=null;this._ready=!1;this._dbInfo=null;this._wrapLibraryMethodsWithReady();this.setDriver(this._config.driver).catch(function(){})}return a.prototype.config=function(a){if("object"===
(void 0===a?"undefined":oa(a))){if(this._ready)return Error("Can't call config() after localforage has been used.");for(var b in a){if("storeName"===b&&(a[b]=a[b].replace(/\W/g,"_")),"version"===b&&"number"!=typeof a[b])return Error("Database version must be a number.");this._config[b]=a[b]}return!("driver"in a&&a.driver)||this.setDriver(this._config.driver)}return"string"==typeof a?this._config[a]:this._config},a.prototype.defineDriver=function(a,b,d){var c=new p(function(b,d){try{var c=a._driver,
f=Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!a._driver)return void d(f);for(var h=X.concat("_initStorage"),g=0,l=h.length;g<l;g++){var m=h[g];if((!qa(O,m)||a[m])&&"function"!=typeof a[m])return void d(f)}(function(){for(var b=function(a){return function(){var b=p.reject(Error("Method "+a+" is not implemented by the current driver"));return k(b,arguments[arguments.length-1]),b}},d=0,c=O.length;d<c;d++){var f=O[d];a[f]||(a[f]=b(f))}})();f=function(d){L[c]&&
console.info("Redefining LocalForage driver: "+c);L[c]=a;ja[c]=d;b()};"_support"in a?a._support&&"function"==typeof a._support?a._support().then(f,d):f(!!a._support):f(!0)}catch(U){d(U)}});return q(c,b,d),c},a.prototype.driver=function(){return this._driver||null},a.prototype.getDriver=function(a,b,d){a=L[a]?p.resolve(L[a]):p.reject(Error("Driver not found."));return q(a,b,d),a},a.prototype.getSerializer=function(a){var b=p.resolve(W);return q(b,a),b},a.prototype.ready=function(a){var b=this,d=b._driverSet.then(function(){return null===
b._ready&&(b._ready=b._initDriver()),b._ready});return q(d,a,a),d},a.prototype.setDriver=function(a,b,d){function c(){g._config.driver=g.driver()}function f(a){return g._extend(a),c(),g._ready=g._initStorage(g._config),g._ready}function h(a){return function(){function b(){for(;d<a.length;){var h=a[d];return d++,g._dbInfo=null,g._ready=null,g.getDriver(h).then(f).catch(b)}c();return g._driverSet=p.reject(Error("No available storage method found.")),g._driverSet}var d=0;return b()}}var g=this;fa(a)||
(a=[a]);var k=this._getSupportedDrivers(a);return this._driverSet=(null!==this._driverSet?this._driverSet.catch(function(){return p.resolve()}):p.resolve()).then(function(){var a=k[0];return g._dbInfo=null,g._ready=null,g.getDriver(a).then(function(a){g._driver=a._driver;c();g._wrapLibraryMethodsWithReady();g._initDriver=h(k)})}).catch(function(){c();return g._driverSet=p.reject(Error("No available storage method found.")),g._driverSet}),q(this._driverSet,b,d),this._driverSet},a.prototype.supports=
function(a){return!!ja[a]},a.prototype._extend=function(a){V(this,a)},a.prototype._getSupportedDrivers=function(a){for(var b=[],d=0,c=a.length;d<c;d++){var f=a[d];this.supports(f)&&b.push(f)}return b},a.prototype._wrapLibraryMethodsWithReady=function(){for(var a=0,b=X.length;a<b;a++)na(this,X[a])},a.prototype.createInstance=function(b){return new a(b)},a}());c.exports=G},{3:3}]},{},[4])(4)});
let dbrStoreConsumption,dbrStoreLicenseInfo,dbrBSendSmallRecordsForDebug,dbrSessionDuration,dbrNextPostConsumptionTime=-Infinity,dbrNextTaskId=0,dbrTaskCallbackMap=new Map,dbrAESGCMKey,dbrFuncGenAESGCMKey=()=>self.crypto.subtle.importKey("raw",new Uint8Array([80,88,27,82,145,164,199,211,187,87,89,128,150,44,190,213,99,181,118,158,215,103,76,117,29,83,122,137,5,180,157,114]),"AES-GCM",!0,["encrypt","decrypt"]),dbrFuncDecryptAndAtob=e=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){if(self.crypto&&
self.crypto.subtle&&self.crypto.subtle.importKey){var a=atob(e),c=new Uint8Array(a.length);for(let e=0;e<a.length;++e)c[e]=a.charCodeAt(e);a=c.subarray(0,12);c=c.subarray(a.length);dbrAESGCMKey||(dbrAESGCMKey=yield dbrFuncGenAESGCMKey());c=yield self.crypto.subtle.decrypt({name:"AES-GCM",iv:a,tagLength:128},dbrAESGCMKey,c);return String.fromCharCode.apply(null,new Uint8Array(c))}return yield new Promise((a,c)=>{let k=dbrNextTaskId++;dbrTaskCallbackMap.set(k,e=>{if(e.success)return dbrBWasmDebug&&
console.log(e.txt),a(e.txt);{let a=Error(e.message);a.stack+="\n"+e.stack;return c(a)}});parentPort.postMessage({type:"taskd",taskID:k,txt:e})})}),dbrFuncEncryptAndBtoa=e=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){if(self.crypto&&self.crypto.subtle&&self.crypto.subtle.importKey){var a=new Uint8Array(e.length);for(var c=0;c<e.length;++c)a[c]=e.charCodeAt(c);c=self.crypto.getRandomValues(new Uint8Array(12));dbrAESGCMKey||(dbrAESGCMKey=yield dbrFuncGenAESGCMKey());a=yield self.crypto.subtle.encrypt({name:"AES-GCM",
iv:c,tagLength:128},dbrAESGCMKey,a);a=new Uint8Array(a);let m=new Uint8Array(c.length+a.length);m.set(c);m.set(a,c.length);return btoa(String.fromCharCode.apply(null,m))}return yield new Promise((a,c)=>{let k=dbrNextTaskId++;dbrTaskCallbackMap.set(k,e=>{if(e.success)return dbrBWasmDebug&&console.log(e.txt),a(e.txt);{let a=Error(e.message);a.stack+="\n"+e.stack;return c(a)}});parentPort.postMessage({type:"taske",taskID:k,txt:e})})});
var Module={locateFile:function(e){return"libDynamsoftBarcodeReader.wasm"==e?dbrBNode?dbrEngineResourcePath+"dbr-"+dbrVersion+".node.wasm":dbrEngineResourcePath+"dbr-"+dbrVersion+(dbrBUseFullFeature?".full":"")+".wasm":dbrEngineResourcePath+e},print:e=>{parentPort.postMessage({type:"log",message:e})},printErr:e=>{console.error(e);parentPort.postMessage({type:"log",message:e})},onRuntimeInitialized:function(){return $jscomp.asyncExecutePromiseGeneratorFunction(function*(){parentPort.postMessage({type:"log",
message:"wasm initialized, cost "+(Date.now()-dbrTimeStartLoadWasm)+" ms"});let e={productKeys:dbrProductKeys,domain:dbrDomain};dbrBWasmDebug&&(e.bDebug=!0);if(dbrBRuntimeKeys){yield dbrPromiseGetLicense;let a=dbrLicenseInfo;if(a instanceof Error){parentPort.postMessage({type:"load",success:!1,message:a.message,stack:a.stack});setTimeout(()=>{throw a;},0);return}if(!a.productKeys){parentPort.postMessage({type:"load",success:!1,message:a.message,stack:""});return}a.message&&parentPort.postMessage({type:"log",
message:a.message});dbrSessionDuration=1E3*a.sessionDuration;e.runtimeKeys=dbrProductKeys;e.productKeys=a.productKeys;e.consumeType=a.consumeType;e.urlGetLicense="";e.aryUrlPostConsume=e.sm_aryUrlPostConsume=[];e.bNewDevice=dbrBNewDevice;e.uuid=dbrDeviceId;e.initTime=Date.now().toString();sendConsume();setInterval(sendConsume,dbrSessionDuration)}Module.BarcodeReaderWasm.init(JSON.stringify(e));parentPort.postMessage({type:"load",success:!0,version:Module.BarcodeReaderWasm.getVersion()})})}};
let DBR_MapInstances=new Map,nextInstanceID=0;
parentPort.onmessage=function(e){return $jscomp.asyncExecutePromiseGeneratorFunction(function*(){var a=e.data?e.data:e,c=a.id,m=a.instanceID;const l=a.body;switch(a.type){case "loadWasm":dbrBWasmDebug=a.bWasmDebug;dbrEngineResourcePath=a.engineResourcePath;dbrVersion=a.version;dbrProductKeys=a.productKeys;dbrDomain=a.domain;dbrBUseFullFeature=a.bUseFullFeature;dbrDeviceId=a.deviceId;dbrBrowserInfo=a.browserInfo;dbrDeviceFriendlyName=a.deviceFriendlyName;dbrLicenseServer=a.licenseServer?a.licenseServer:
dbrLicenseServer;dbrBSendSmallRecordsForDebug=a.bSendSmallRecordsForDebug;parentPort.postMessage({type:"log",message:"wasm loading..."});dbrTimeStartLoadWasm=Date.now();if(dbrBNode){a=Module;Module=require("./dbr-"+dbrVersion+".node.wasm.js");for(let d in a)Module[d]=a[d]}else importScripts(dbrEngineResourcePath+"dbr-"+dbrVersion+(dbrBUseFullFeature?".full":"")+".wasm.js");(dbrBRuntimeKeys=8==dbrProductKeys.length)&&(dbrPromiseGetLicense=(()=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){try{yield(yield localforage.createInstance({name:"dbrjshello"})).setItem("dbrjshello",
"available")}catch(v){localforage=function(a){this.dbname=a};localforage.createInstance=function(a){return $jscomp.asyncExecutePromiseGeneratorFunction(function*(){return new localforage(a.name)})};var a=a=>function(){let d=[];for(let a=0;a<arguments.length;++a)d.push(arguments[a]);return new Promise((c,e)=>{let h=dbrNextTaskId++;dbrTaskCallbackMap.set(h,a=>{if(a.success)return dbrBWasmDebug&&console.log(a.result),c(a.result);{let d=Error(a.message);d.stack+="\n"+a.stack;return e(d)}});parentPort.postMessage({type:"localforage",
taskID:h,dbname:this.dbname,method:a,paras:d})})};localforage.prototype.setItem=a("setItem");localforage.prototype.getItem=a("getItem");localforage.prototype.removeItem=a("removeItem");localforage.prototype.keys=a("keys")}dbrStoreLicenseInfo=yield localforage.createInstance({name:"dbrjsLicenseInfo"});dbrStoreConsumption=yield localforage.createInstance({name:"dbrjs"+dbrProductKeys+"unsV2"});dbrBNewDevice=!(yield dbrStoreLicenseInfo.getItem(dbrProductKeys+"old"));a=Date.now();let c;var e;let k=!0,
l,m;if(e=yield dbrStoreLicenseInfo.getItem(dbrProductKeys))[c,l,e]=e,k=a>e,a>c&&(yield dbrStoreLicenseInfo.removeItem(dbrProductKeys),l=null);try{m=yield Promise.race([fetch(dbrLicenseServer+"api/verification/"+dbrProductKeys).then(a=>{if(a.ok)return a.text();throw Error("Network Error. Can't get license.");}),new Promise((a,d)=>{setTimeout(()=>d(Error("Network Error. Request timeout.")),k?15E3:3E3)})])}catch(v){if(dbrBWasmDebug&&console.error(v),k){dbrLicenseInfo=v;return}}e=a=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){return yield dbrFuncDecryptAndAtob(a).then(a=>
JSON.parse(a)).catch(()=>Error("Parse Error. Can't get valid license."))});if(m){dbrLicenseInfo=yield e(m);var q="device"==dbrLicenseInfo.consumeType;dbrLicenseInfo.productKeys?yield dbrStoreLicenseInfo.setItem(dbrProductKeys,[a+864E5*(q?366:7),m,a+6048E5]):q&&(q=dbrLicenseInfo,dbrLicenseInfo=yield e(l),dbrLicenseInfo.message=q.message,yield dbrStoreLicenseInfo.setItem(dbrProductKeys,[c,m,Math.min(a+6048E5,c)]))}else dbrLicenseInfo=yield e(l)}))());break;case "createInstance":m=nextInstanceID++;try{let d=
new Module.BarcodeReaderWasm(a.bScanner,m);DBR_MapInstances.set(m,d);let c=JSON.parse(d.getRuntimeSettings());a.bScanner?(c.localizationModes=[2,0,0,0,0,0,0,0],c.deblurLevel=0):(c.expectedBarcodesCount=512,c.scaleDownThreshold=1E5,c.timeout=1E5);dbrBNode||dbrBUseFullFeature||(c.barcodeFormatIds=234883071);d.updateRuntimeSettings(JSON.stringify(c))}catch(d){handleErr(d,c);break}parentPort.postMessage({type:"task",id:c,body:{success:!0,instanceID:m}});break;case "destroy":try{DBR_MapInstances.get(m).delete(),
DBR_MapInstances.delete(m)}catch(d){handleErr(d,c);break}parentPort.postMessage({type:"task",id:c,body:{success:!0}});break;case "decodeBuffer":{let a;try{a=JSON.parse(DBR_MapInstances.get(m).decodeBuffer(l.buffer,l.width,l.height,l.stride,l.format))}catch(h){handleErr(h,c);break}parentPort.postMessage({type:"task",id:c,body:{success:!0,decodeReturn:a}});break}case "decodeFileInMemory":{let a;try{a=JSON.parse(DBR_MapInstances.get(m).decodeFileInMemory(l.bytes))}catch(h){handleErr(h,c);break}parentPort.postMessage({type:"task",
id:c,body:{success:!0,decodeReturn:a}});break}case "clearMapDecodeRecord":try{DBR_MapInstances.get(m).clearMapDecodeRecord()}catch(d){handleErr(d,c);break}parentPort.postMessage({type:"task",id:c,body:{success:!0}});break;case "getRuntimeSettings":{let a;try{a=DBR_MapInstances.get(m).getRuntimeSettings()}catch(h){handleErr(h,c);break}parentPort.postMessage({type:"task",id:c,body:{success:!0,results:a}});break}case "updateRuntimeSettings":{let a;try{a=JSON.parse(DBR_MapInstances.get(m).updateRuntimeSettings(l.settings))}catch(h){handleErr(h,
c);break}parentPort.postMessage({type:"task",id:c,body:{success:!0,updateReturn:a}});break}case "resetRuntimeSettings":try{let a=DBR_MapInstances.get(m);a.resetRuntimeSettings();let c=JSON.parse(a.getRuntimeSettings());a.bScanner?(c.localizationModes=[2,0,0,0,0,0,0,0],c.deblurLevel=0):(c.expectedBarcodesCount=512,c.scaleDownThreshold=1E5,c.timeout=1E5);dbrBUseFullFeature||(c.barcodeFormatIds=234883071);a.updateRuntimeSettings(JSON.stringify(c))}catch(d){handleErr(e,c);break}parentPort.postMessage({type:"task",
id:c,body:{success:!0}});break;case "outputSettingsToString":{let a;try{a=DBR_MapInstances.get(m).outputSettingsToString()}catch(h){handleErr(h,c);break}parentPort.postMessage({type:"task",id:c,body:{success:!0,results:a}});break}case "initRuntimeSettingsWithString":{let a;try{a=JSON.parse(DBR_MapInstances.get(m).initRuntimeSettingsWithString(l.settings))}catch(h){handleErr(h,c);break}parentPort.postMessage({type:"task",id:c,body:{success:!0,initReturn:a}});break}case "getIntermediateResults":{let a=
null;try{var k=DBR_MapInstances.get(m).getIntermediateResults(),q=JSON.parse(k,(d,c)=>"bytes"===d&&"ptr"in c&&"length"in c?a=Module.BarcodeReaderWasm.getBytes(c.ptr,c.length):c)}catch(h){handleErr(h,c);break}parentPort.postMessage({type:"task",id:c,body:{success:!0,results:q}});DBR_MapInstances.get(m).freeIntermediateResults();break}case "setModeArgument":{let a;try{a=JSON.parse(DBR_MapInstances.get(m).setModeArgument(l.modeName,l.index,l.argumentName,l.argumentValue))}catch(h){handleErr(h,c);break}parentPort.postMessage({type:"task",
id:c,body:{success:!0,setReturn:a}});break}case "getModeArgument":{let a;try{a=JSON.parse(DBR_MapInstances.get(m).getModeArgument(l.modeName,l.index,l.argumentName))}catch(h){handleErr(h,c);break}parentPort.postMessage({type:"task",id:c,body:{success:!0,getReturn:a}});break}case "updateScanSettings":try{let a=DBR_MapInstances.get(m),c=l.settings;a.duplicateForgetTime=c.duplicateForgetTime;a.oneDRememberFrameCount=c.oneDRememberFrameCount;a.oneDTrustFrameCount=c.oneDTrustFrameCount;c.frameFilter?a.setFrameFilter(JSON.stringify(c.frameFilter)):
a.setFrameFilter("")}catch(d){handleErr(d,c);break}parentPort.postMessage({type:"task",id:c,body:{success:!0}});break;case "getScanSettings":a={};try{let c=DBR_MapInstances.get(m);a.duplicateForgetTime=c.duplicateForgetTime;a.oneDRememberFrameCount=c.oneDRememberFrameCount;a.oneDTrustFrameCount=c.oneDTrustFrameCount;let e=c.getFrameFilter();e&&(a.frameFilter=JSON.parse(e))}catch(d){handleErr(d,c);break}parentPort.postMessage({type:"task",id:c,body:{success:!0,results:a}});break;case "task":c=a.id;
a=a.body;try{dbrTaskCallbackMap.get(c)(a),dbrTaskCallbackMap.delete(c)}catch(d){throw dbrTaskCallbackMap.delete(c),d;}break;default:console.warn("Unmatched task: ",e)}})};if(dbrBNode)parentPort.on("message",parentPort.onmessage);
let handleErr=(e,a)=>{parentPort.postMessage({type:"task",id:a,body:{success:!1,message:e.message,stack:e.stack}});setTimeout(()=>{throw e;},0)},addConsumeRecordToDB=e=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){dbrBWasmDebug&&console.log("%c","color:#0f0",atob(e));yield dbrStoreConsumption.setItem(Date.now().toString(),e);dbrNextPostConsumptionTime<Date.now()&&(dbrNextPostConsumptionTime=Date.now()+dbrSessionDuration,sendConsume())}),sendConsume=()=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){dbrPromisePostConsumption=
dbrPromisePostConsumption.then(()=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){var e=Date.now();let a=yield dbrStoreConsumption.keys();if(a.length){dbrBWasmDebug&&console.log("get keys to filter for send: %o",a);var c=[],m=new Map;for(let k of a){let a=JSON.parse(atob(yield dbrStoreConsumption.getItem(k))),d;dbrBNewDevice?(dbrBNewDevice=!1,yield dbrStoreLicenseInfo.setItem(dbrProductKeys+"old",btoa(dbrDeviceId)),d=Math.floor(a.decodeTime/dbrSessionDuration)*dbrSessionDuration):d=Math.ceil(a.decodeTime/
dbrSessionDuration)*dbrSessionDuration;dbrBSendSmallRecordsForDebug&&(d=parseInt(a.decodeTime));dbrBWasmDebug&&console.log("timeKey: %d, dateNow: %d",d,e);if(d>e)continue;c.push(k);let h=m.has(d)?m.get(d):{all:0,oned:0,qr:0,pdf417:0,dm:0,mc:0,other:0};h.all+=a.consumption.all;h.oned+=a.consumption.oned;h.qr+=a.consumption.qr;h.pdf417+=a.consumption.pdf417;h.dm+=a.consumption.dm;h.mc+=a.consumption.mc;h.other+=a.consumption.other;m.set(d,h)}if(c.length){dbrBWasmDebug&&console.log("get keys for send: %o",
a);dbrNextPostConsumptionTime=e+dbrSessionDuration;var l=[];m.forEach((a,c)=>{l.push({recordTime:c,consumption:a})});e={version:"2",runtimeKeys:dbrProductKeys,uuid:dbrDeviceId,browserInfo:dbrBrowserInfo,deviceFriendlyName:dbrDeviceFriendlyName,postTime:Date.now(),records:l};dbrBWasmDebug&&dbrBWasmDebug&&console.log(e);yield fetch(dbrLicenseServer+"api/verification",{mode:"cors",method:"POST",body:yield dbrFuncEncryptAndBtoa(JSON.stringify(e))}).then(a=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){if(a.ok)for(let a of c)yield dbrStoreConsumption.removeItem(a)}),
a=>{console.error(a)})}}}))});
